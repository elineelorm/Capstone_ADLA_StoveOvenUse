import pandas as pd
from imblearn.over_sampling import SMOTE
from sklearn.model_selection import train_test_split


# Load data
data = pd.read_excel('Test.csv')


# Define features (X) and target (y)
X = data.drop('safety', axis=1)
y = data['safety']

# Split the dataset into train and test sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)

# Apply SMOTE to the training set
smote = SMOTE(sampling_strategy='minority', random_state=42)
X_train_resampled, y_train_resampled = smote.fit_resample(X_train, y_train)

# Save the resampled training set to a new CSV file
resampled_data = pd.concat([X_train_resampled, y_train_resampled], axis=1)
resampled_data.to_csv('TestData_resampled.csv', index=False)

